<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gestión de Contactos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }

    .container {
      max-width: 800px;
      margin: auto;
      padding: 20px;
      background-color: #fff;
    }

    .contact-card {
      border: 1px solid #ddd;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      background-color: #fafafa;
    }

    .contact-header {
      display: flex;
      align-items: center;
    }

    .contact-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      margin-right: 15px;
    }

    .btn {
      padding: 6px 12px;
      margin-right: 5px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .btn-success {
      background-color: #28a745;
      color: white;
    }

    .btn-primary {
      background-color: #007bff;
      color: white;
    }

    .btn-danger {
      background-color: #dc3545;
      color: white;
    }

    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }

    footer {
      text-align: center;
      padding: 10px;
      background-color: #222;
      color: white;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <div class="container" id="contact-list-view">
    <h1>Lista de Contactos</h1>
    <button class="btn btn-success" id="btn-add-contact">Agregar Contacto</button>
    <div id="contacts-container"></div>
  </div>

  <div class="container" id="add-contact-view" style="display:none;">
    <h1>Agregar / Editar Contacto</h1>
    <form id="contact-form">
      <label for="full_name">Nombre completo</label>
      <input type="text" id="full_name" name="full_name" required />

      <label for="email">Email</label>
      <input type="email" id="email" name="email" required />

      <label for="phone">Teléfono</label>
      <input type="tel" id="phone" name="phone" />

      <label for="address">Dirección</label>
      <input type="text" id="address" name="address" />

      <div style="margin-top: 20px;">
        <button type="submit" class="btn btn-primary">Guardar</button>
        <button type="button" class="btn btn-secondary" id="btn-cancel">Cancelar</button>
      </div>
    </form>
  </div>

  <footer>
    &copy; 2025 Gestión de Contactos. Todos los derechos reservados.
  </footer>

  <script>
    let fixedContacts = JSON.parse(localStorage.getItem("fixedContacts")) || [
      {
        full_name: "Juan Pérez",
        email: "juan@example.com",
        phone: "555-1234",
        address: "Calle Falsa 123",
        avatar: "https://randomuser.me/api/portraits/men/32.jpg",
      },
      {
        full_name: "María López",
        email: "maria.lopez@mail.com",
        phone: "555-5678",
        address: "Avenida Siempre Viva 742",
        avatar: "https://randomuser.me/api/portraits/women/45.jpg",
      },
      {
        full_name: "Carlos González",
        email: "carlos.gonzalez@mail.com",
        phone: "555-9101",
        address: "Calle del Sol 456",
        avatar: "https://randomuser.me/api/portraits/men/22.jpg",
      },
      {
        full_name: "Ana Fernández",
        email: "ana.fernandez@mail.com",
        phone: "555-1122",
        address: "Camino Verde 789",
        avatar: "https://randomuser.me/api/portraits/women/56.jpg",
      },
    ];

    let userContacts = JSON.parse(localStorage.getItem("contacts")) || [];

    const btnAddContact = document.getElementById("btn-add-contact");
    const btnCancel = document.getElementById("btn-cancel");
    const contactListView = document.getElementById("contact-list-view");
    const addContactView = document.getElementById("add-contact-view");
    const contactForm = document.getElementById("contact-form");
    const contactsContainer = document.getElementById("contacts-container");

    let editIndex = null;

    function saveContacts() {
      localStorage.setItem("contacts", JSON.stringify(userContacts));
      localStorage.setItem("fixedContacts", JSON.stringify(fixedContacts));
    }

    function renderContacts() {
      contactsContainer.innerHTML = "";

      fixedContacts.forEach((c, i) => {
        const card = document.createElement("div");
        card.classList.add("contact-card");
        card.innerHTML = `
          <div class="contact-header">
            <img class="contact-avatar" src="${c.avatar}" alt="Avatar ${c.full_name}" />
            <h3>${c.full_name}</h3>
          </div>
          <p><strong>Email:</strong> ${c.email}</p>
          <p><strong>Teléfono:</strong> ${c.phone}</p>
          <p><strong>Dirección:</strong> ${c.address}</p>
          <button class="btn btn-primary btn-edit-fixed" data-index="${i}">Editar</button>
          <button class="btn btn-danger btn-delete-fixed" data-index="${i}">Eliminar</button>
        `;
        contactsContainer.appendChild(card);
      });

      userContacts.forEach((c, i) => {
        const card = document.createElement("div");
        card.classList.add("contact-card");
        card.innerHTML = `
          <div class="contact-header">
            <img class="contact-avatar" src="${c.avatar || "https://randomuser.me/api/portraits/lego/1.jpg"}" alt="Avatar ${c.full_name}" />
            <h3>${c.full_name}</h3>
          </div>
          <p><strong>Email:</strong> ${c.email}</p>
          <p><strong>Teléfono:</strong> ${c.phone}</p>
          <p><strong>Dirección:</strong> ${c.address}</p>
          <button class="btn btn-primary btn-edit" data-index="${i}">Editar</button>
          <button class="btn btn-danger btn-delete" data-index="${i}">Eliminar</button>
        `;
        contactsContainer.appendChild(card);
      });

      // Editar contacto de usuario
      document.querySelectorAll(".btn-edit").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          editIndex = e.target.getAttribute("data-index");
          const c = userContacts[editIndex];
          contactForm.full_name.value = c.full_name;
          contactForm.email.value = c.email;
          contactForm.phone.value = c.phone;
          contactForm.address.value = c.address;
          contactListView.style.display = "none";
          addContactView.style.display = "block";
        });
      });

      // Eliminar contacto de usuario
      document.querySelectorAll(".btn-delete").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          const idx = e.target.getAttribute("data-index");
          if (confirm("¿Seguro que quieres eliminar este contacto?")) {
            userContacts.splice(idx, 1);
            saveContacts();
            renderContacts();
          }
        });
      });

      // Editar contacto fijo
      document.querySelectorAll(".btn-edit-fixed").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          const idx = e.target.getAttribute("data-index");
          const c = fixedContacts[idx];
          contactForm.full_name.value = c.full_name;
          contactForm.email.value = c.email;
          contactForm.phone.value = c.phone;
          contactForm.address.value = c.address;
          editIndex = null;
          contactListView.style.display = "none";
          addContactView.style.display = "block";
        });
      });

      // Eliminar contacto fijo
      document.querySelectorAll(".btn-delete-fixed").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          const idx = e.target.getAttribute("data-index");
          if (confirm("¿Eliminar este contacto fijo? Se moverá a tu lista editable.")) {
            const c = fixedContacts[idx];
            userContacts.push({...c});
            fixedContacts.splice(idx, 1);
            saveContacts();
            renderContacts();
          }
        });
      });
    }

    btnAddContact.addEventListener("click", () => {
      contactForm.reset();
      editIndex = null;
      contactListView.style.display = "none";
      addContactView.style.display = "block";
    });

    btnCancel.addEventListener("click", () => {
      addContactView.style.display = "none";
      contactListView.style.display = "block";
    });

    contactForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const newContact = {
        full_name: contactForm.full_name.value.trim(),
        email: contactForm.email.value.trim(),
        phone: contactForm.phone.value.trim(),
        address: contactForm.address.value.trim(),
        avatar: "",
      };

      if (editIndex !== null) {
        userContacts[editIndex] = newContact;
      } else {
        userContacts.push(newContact);
      }
      saveContacts();
      renderContacts();
      addContactView.style.display = "none";
      contactListView.style.display = "block";
    });

    renderContacts();
  </script>
</body>
</html>
